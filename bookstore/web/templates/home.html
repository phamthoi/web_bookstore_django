{% extends 'base.html' %}

{% load static %}

{% block main-container-content %}
    <style>
      h2{
        color: #1eafbb;
        font-weight: bold;
        font-size: 40px;
        text-align: center;
      }
    </style>
    <div class="container">
      <div class="title" style="padding-top: 20px;">
        <h2>Sách hiện có</h2>
      </div>
    </div>
    <div class="container">
      <table class="table table-hover"> 
        <thead style="background-color: black; color: white;">
          <tr>
            <td>Mã sách</td>
            <td>Bìa sách</td>
            <td>Tên sách</td>
            <td>Tác giả</td>
            <td>Hành động</td>
          </tr>
        </thead>
        <tbody>
          {% for item in BF %}
          <tr>
            <td>{{ item.book_id }}</td>
            <td><img src="/web/media/{{item.cover_book}}" alt="cover book" class="img" style="width: 50px; height: 80px;"></td>
            <td>{{ item.title }}</td>
            <td>{{ item.author }}</td>
            <td>
              <button class="btn btn-secondary"><a href="/web/media/{{item.book}}" target="_blank" style="text-decoration: none; color: white;">Xem</a></button>
              <button class="btn btn-primary"><a href="/web/media/{{item.book}}"  download="" style="text-decoration: none; color: white;">Tải sách</a></button>
              <button class="btn btn-primary" onclick="toggleFavorite(this, {{ item.book_id }}, {{ item.is_favorite|yesno:"true,false" }})">
                <a style="text-decoration: none; color: white;">{% if item.is_favorite %}Bỏ yêu thích{% else %}Yêu thích{% endif %}</a>
              </button>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <script>
      function toggleFavorite(button, bookId, isFavorite) {
        fetch(`/toggle_favorite/${bookId}/`)
          .then(response => response.json())
          .then(data => {
            if (data.is_favorite) {
              button.innerHTML = '<a style="text-decoration: none; color: white;">Bỏ yêu thích</a>';
            } else {
              button.innerHTML = '<a style="text-decoration: none; color: white;">Yêu thích</a>';
            }
          })
          .catch(error => console.error('Error:', error));
      }
    </script>
    
    
{% endblock %}
